---
title: '"Piperacillin Dose–Exposure Modelling Using Linear Regression"'
author: "Ketsia Efoloko"
date: "2026-01-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, 
  message = FALSE,
  warning = FALSE
)
```

1. Introduction

Piperacillin is a β-lactam antibiotic commonly administered by continuous
infusion. At steady state, drug concentration is expected to increase
linearly with infusion rate.

This report investigates the relationship between infusion rate and
steady-state concentration (Css) using linear regression, with the
objective of identifying infusion rates that achieve a target Css of
16 mg/L, including a conservative dose ensuring 90% target attainment.

2. Methods
2.1 Software

library(tidyverse)

2.2 Data Import

Piperacillin <- read_csv("https://raw.githubusercontent.com/dlonsdal/SGUL_PK_data/main/pip_ss.csv")

2.3 Exploratory Analysis

p_scatter <- ggplot(Piperacillin,aes(infusion_rate, pip_ss))+
  geom_point()+
  stat_smooth(method='lm', colour='blue',se=F)+
  theme_bw()+
  labs(
    x='Infusion Rate (mg/hr)', 
    y='Steady-State Concentration (mg/L)',
    title = "Piperacillin Steady-State Concentration vs Infusion Rate") 

ggsave("pip_ss_vs_rate.pdf", p_scatter, width = 7, height = 5)

2.4 Correlation Analysis

cor_test <- cor.test(
  Piperacillin$infusion_rate, 
  Piperacillin$pip_ss, 
  method='pearson')


2.5 Linear Regression Model

Piperacillin_model <- lm(pip_ss~infusion_rate, data=Piperacillin)
summary(Piperacillin_model)

2.6 Clearance Estimation

At steady state: Css = Infusion rate / CL


Thus, the slope of the regression ≈  1/CL.
mean_clearance <- 1 / coef(Piperacillin_model)[2]
mean_clearance

2.7 Infusion Rate for Target Css = 16 mg/L

target_css <- 16

rate_mean_16 <- (target_css - coef(Piperacillin_model)[1]) / coef(Piperacillin_model)[2]
rate_mean_16

2.8 Infusion Rate for 90% Target Attainment

Prediction intervals were first examined at observed infusion rates to
identify a plausible dosing window. Subsequent analyses focused on the
range 210–240 mg/hour.

Prediction_interval <- predict(Piperacillin_model, interval = 'prediction', level = 0.8)
Piperacillin <- cbind(Piperacillin,Prediction_interval)

Pip_16 <- data.frame(infusion_rate=seq(210,240,by=5)) # 16 mg/l falls between infusion rates of 210 to 240
infusion_interval <- predict(Piperacillin_model, newdata=Pip_16, interval = 'prediction', level = 0.8)
Pip_16 <- cbind(Pip_16,infusion_interval)

The minimum infusion rate ensuring that the lower prediction bound
exceeds 16 mg/L was selected.

rate_90_target <- Pip_16 %>%
  filter(lwr >= 16) %>%
  slice(1)

rate_90_target

3. Results

A strong positive correlation was observed between infusion rate and
steady-state concentration. Linear regression adequately described the
relationship, supporting the assumption of linear pharmacokinetics
within the evaluated range.

An infusion rate of 225 mg/hr was concluded to ensure 90% target attainment 

4. Discussion

This analysis demonstrates how simple regression methods can be used to
support dose selection decisions. The use of prediction intervals enables
clinically conservative dosing strategies that account for inter-individual
variability.

5. Conclusion

Linear regression provides a transparent and reproducible approach to
dose–exposure modelling. This workflow reflects methods commonly used in
early clinical pharmacology and data analysis settings